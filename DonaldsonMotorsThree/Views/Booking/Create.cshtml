@model DonaldsonMotorsThree.ViewModels.BookingFormViewModel


@{
    ViewBag.Title = "Book Job";
}

<h2><b><em>Book a Job</em></b></h2>

<br/>
<br/>

<form>
    <div class="form-group" id="job">
        <label>Job</label>
        <input class="typeahead form-control" type="text" value=""  />
    </div>
    <div class="form-group">
        <label>Parts</label>
        <input type="text" value="" class="form-control" />
    </div>
    
    <div class="form-group">
        <label>Desired Completion Date</label>
        <input type="date" value="" class="form-control" />
    </div>
    <br/>
    <br/>
    <button class="btn btn-primary">Continue</button>
</form>

   


@section scripts
{
@Scripts.Render("~/bundles/jqueryval")

    <script>

        // When DOM is Ready //
        $(document).ready(function() {
            // Initialise ViewModel with Array for JobIds //
            var vm = {
                jobIds: [] 
            };

            // Bloodhound engine for search optimization // 
            var jobs = new Bloodhound({
                datumTokenizer: Bloodhound.tokenizers.obj.whitespace('jobRequirements'),
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                
                remote: {
                    url: '/api/jobs?query=%QUERY',
                    wildcard: '%QUERY'
                }
            });

            // Start typeahead when length = 2 chars name:<> display:<> source:<> //
            $('#job .typeahead').typeahead({
                    minLength: 2,
                    highlight: true
                },
                {
                    name: 'jobs',
                    display: 'JobRequirements',
                    source: jobs
                });
        }).on("typeahead:select",
            //When a Job item has been selected, append selected job onto list //
            function(e, job) {
                $("#job").append("<li class='list-group-item'>" + job.jobrequirements + "</li>");

                $("#job").typeahead("val", "");

                vm.jobIds.push(job.id);
            });

    </script>

}

